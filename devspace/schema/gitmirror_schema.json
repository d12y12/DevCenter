{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "gitmirror_schema.json",
  "type": "object",
  "required": [
    "type",
    "port",
    "localization",
    "services"
  ],
  "properties": {
    "type": {
      "type": "string",
      "const": "GitMirror"
    },
    "port": {
      "type": "integer",
      "minimum": 8000,
      "maximum": 9000
    },
    "localization": {
      "type": "boolean"
    },
    "services": {
      "$id": "#/properties/services",
      "type": "object",
      "patternProperties": {
        "^([a-zA-Z\\d](?:[a-zA-Z\\d]|-(?=[a-zA-Z\\d])){0,9})$": {
          "$ref": "#/definitions/service"
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false,
  "definitions": {
    "service": {
      "$id": "#/definitions/service",
      "type": "object",
      "required": [
        "synchronization",
        "cgit_options",
        "repositories"
      ],
      "properties": {
        "synchronization": {
          "$ref": "#/definitions/synchronization"
        },
        "cgit_options": {
          "$ref": "#/definitions/cgit_options"
        },
        "repositories": {
          "$ref": "#/definitions/repositories"
        }
      },
      "additionalProperties": false
    },
    "synchronization": {
      "$id": "#/definitions/synchronization",
      "type": "object",
      "required": [
        "consistency",
        "crontab"
      ],
      "properties": {
        "consistency": {
          "type": "boolean"
        },
        "crontab": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "cgit_options": {
      "type": "object",
      "$id": "#/definitions/cgit_options",
      "required": [
        "title",
        "description",
        "max-repo-count"
      ],
      "properties": {
        "title": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "max-repo-count": {
          "type": "integer"
        },
        "logo": {
          "type": "object",
          "required": [
            "light",
            "dark"
          ],
          "properties": {
            "light": {
              "type": "string"
            },
            "dark": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "repositories": {
      "type": "object",
      "required": [
        "cgit",
        "github"
      ],
      "properties": {
        "cgit": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/cgit_repository"
          },
          "uniqueItems": true
        },
        "github": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/github_repository"
          },
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    },
    "cgit_repository": {
      "type": "object",
      "$id": "#/definitions/cgit_repository",
      "required": [
        "source",
        "excludes",
        "targets"
      ],
      "properties": {
        "source": {
          "type": "string",
          "format": "uri",
          "pattern": "^(https?)://"
        },
        "excludes": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri",
            "pattern": "^(https?)://"
          },
          "uniqueItems": true
        },
        "targets": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri",
            "pattern": "^(https?)://"
          },
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    },
    "github_repository": {
      "type": "object",
      "$id": "#/definitions/github_repository",
      "required": [
        "source",
        "excludes",
        "targets"
      ],
      "properties": {
        "source": {
          "type": "string",
          "minimum": 1,
          "maximum": 140,
          "pattern": "^([a-zA-Z\\d](?:[a-zA-Z\\d]|-(?=[a-zA-Z\\d])){0,38})(\/[\\w.-]{1,100})?$"
        },
        "excludes": {
          "type": "array",
          "items": {
            "type": "string",
            "minimum": 1,
            "maximum": 140,
            "pattern": "^([a-zA-Z\\d](?:[a-zA-Z\\d]|-(?=[a-zA-Z\\d])){0,38})(\/[\\w.-]{1,100})?$"
          },
          "uniqueItems": true
        },
        "targets": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri",
            "pattern": "^(https?)://"
          },
          "uniqueItems": true
        }
      },
      "additionalProperties": false
    }
  }
}